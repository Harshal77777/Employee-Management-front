<div class="leave-container">
 
  <div class="content">
    <mat-card class="leave-card">
      <h2 class="page-title">Leave Requests</h2>


      <div *ngIf="loading" class="loading-container">
        <mat-spinner></mat-spinner>
      </div>

     
      <div *ngIf="!loading">
        <div class="filter-container">
          <mat-form-field appearance="outline">
            <mat-label>Search Leave Requests</mat-label>
            <input matInput (keyup)="applyFilter($event)" placeholder="Search by employee, email, or reason" />
          </mat-form-field>

          <button mat-raised-button class="download-btn" (click)="exportToExcel()">Download Report</button>
        </div>

        <div class="table-container">
          <table mat-table [dataSource]="dataSource" matSort class="custom-table">
           
             <ng-container matColumnDef="employee">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Employee </th>
              <td mat-cell *matCellDef="let request"> {{ request.employeeId }} </td>
            </ng-container>

            
            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Email </th>
              <td mat-cell *matCellDef="let request"> {{ request.email }} </td>
            </ng-container>

          
            <ng-container matColumnDef="reason">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Reason </th>
              <td mat-cell *matCellDef="let request"> {{ request.reason }} </td>
            </ng-container>

           
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Date </th>
              <td mat-cell *matCellDef="let request"> {{ request.date | date:'mediumDate' }} </td>
            </ng-container>

         
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
              <td mat-cell *matCellDef="let request">
                <span class="status-chip {{ request.status }}">
                  {{ request.status | uppercase }}
                </span>
              </td>
            </ng-container>

          
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef> Actions </th>
              <td mat-cell *matCellDef="let request">
                <button *ngIf="isAdmin" class="approve-btn" (click)="confirmAction(request._id, 'Approved')">
                  Approve
                </button>
                <button *ngIf="isAdmin" class="reject-btn" (click)="confirmAction(request._id, 'Rejected')">
                  Reject
                </button>
              </td>
            </ng-container>

           
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>

        
        <mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
      </div>
    </mat-card>
  </div>
</div>
